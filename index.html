<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Scam Detector</title>
  <style>
    :root{
      --blue:#2563eb; --blue-dark:#1e40af; --blue-soft:#eff6ff;
      --text:#0f172a; --muted:#475569; --danger:#dc2626; --safe:#16a34a; --border:#e2e8f0;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:#ffffff; color:var(--text);
    }
    .wrap{
      max-width:760px; margin:0 auto; padding:32px 16px;
    }
    .card{
      background:#fff; border:1px solid var(--border); border-radius:16px; padding:24px;
      box-shadow:0 6px 20px rgba(37,99,235,.08);
    }
    .title{
      font-size:clamp(20px,3vw,28px); font-weight:800; letter-spacing:.2px; margin:0 0 6px;
      color:var(--blue-dark);
    }
    .subtitle{margin:0 0 20px; color:var(--muted)}
    label{font-weight:600; display:block; margin-bottom:8px}
    textarea{
      width:100%; min-height:140px; padding:14px 16px; resize:vertical;
      border:1px solid var(--border); border-radius:12px; font-size:16px; outline:none;
      transition:border .15s ease, box-shadow .15s ease; background:var(--blue-soft);
    }
    textarea:focus{border-color:var(--blue); box-shadow:0 0 0 4px rgba(37,99,235,.15)}
    .row{display:flex; gap:12px; align-items:center; margin-top:12px}
    .btn{
      appearance:none; border:0; border-radius:999px; padding:12px 18px; font-weight:700;
      background:var(--blue); color:#fff; cursor:pointer; transition:transform .06s ease, background .2s ease;
    }
    .btn:hover{background:var(--blue-dark)}
    .btn:active{transform:translateY(1px)}
    .btn[disabled]{opacity:.6; cursor:not-allowed; transform:none}
    .ghost{background:transparent; color:var(--blue); border:1px solid var(--blue)}
    .status{
      margin-top:18px; font-size:14px; color:var(--muted);
    }
    .result{
      margin-top:18px; padding:16px; border:1px solid var(--border); border-radius:12px; background:#fff;
    }
    .badge{
      display:inline-flex; align-items:center; gap:8px; border-radius:999px; padding:8px 12px; font-weight:700;
    }
    .scam{background: #fee2e2; color:var(--danger); border:1px solid #fecaca;}
    .ok{background: #dcfce7; color:var(--safe); border:1px solid #bbf7d0;}
    .err{background:#fff7ed; color:#c2410c; border:1px solid #fed7aa;}
    .hint{font-size:12px; color:var(--muted); margin-top:6px}
    /* spinner */
    .spinner{
      width:18px; height:18px; border-radius:50%;
      border:3px solid rgba(37,99,235,.25); border-top-color:var(--blue);
      animation:spin .8s linear infinite; display:inline-block; vertical-align:-3px;
    }
    @keyframes spin{to{transform:rotate(360deg)}}
    .footer{margin-top:28px; text-align:center; color:var(--muted); font-size:12px}
    code{background:#f1f5f9; padding:2px 6px; border-radius:6px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1 class="title">‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Scam</h1>
      <p class="subtitle">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äú‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‚Äù ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô Scam ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</p>

      <form id="form">
        <label for="text">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</label>
        <textarea id="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏î‡πà‡∏ß‡∏ô! ‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô..."></textarea>

        <div class="row">
          <button id="submitBtn" class="btn" type="submit">
            ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
          </button>
          <button id="clearBtn" class="btn ghost" type="button">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
        </div>
        <div id="status" class="status" aria-live="polite"></div>
        <div id="result" class="result" style="display:none;"></div>
        <div class="hint">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏´‡∏≤‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≤‡∏°‡πÇ‡∏î‡πÄ‡∏°‡∏ô ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î CORS ‡∏ó‡∏µ‡πà‡∏ù‡∏±‡πà‡∏á API</div>
      </form>
    </div>

    <div class="footer">
      ‡πÉ‡∏ä‡πâ POST ‡πÑ‡∏õ‡∏ó‡∏µ‡πà <code>/predict</code> ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö <code>{"text": "&lt;‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°&gt;"}</code>
    </div>
  </div>

  <script>
    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ URL ‡∏Ç‡∏≠‡∏á API ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
    const API_URL = "https://scam-model-api.onrender.com/predict";

    const form = document.getElementById("form");
    const textInput = document.getElementById("text");
    const submitBtn = document.getElementById("submitBtn");
    const clearBtn = document.getElementById("clearBtn");
    const statusEl = document.getElementById("status");
    const resultEl = document.getElementById("result");

    function setLoading(isLoading){
      if(isLoading){
        submitBtn.setAttribute("disabled","disabled");
        textInput.setAttribute("disabled","disabled");
        submitBtn.innerHTML = '<span class="spinner"></span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...';
        statusEl.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•...";
      }else{
        submitBtn.removeAttribute("disabled");
        textInput.removeAttribute("disabled");
        submitBtn.textContent = "‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå";
        statusEl.textContent = "";
      }
    }

    function showResult(content, type){
      resultEl.style.display = "block";
      if(type === "error"){
        resultEl.innerHTML = `<div class="badge err">‚ö†Ô∏è ${content}</div>`;
      }else if(type === "scam"){
        resultEl.innerHTML = `
          <div class="badge scam">üö® ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏° Scam</div>
          <div style="margin-top:10px">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: ${escapeHtml(textInput.value)}</div>`;
      }else{
        resultEl.innerHTML = `
          <div class="badge ok">‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Scam</div>
          <div style="margin-top:10px">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: ${escapeHtml(textInput.value)}</div>`;
      }
    }

    function escapeHtml(str){
      return str.replace(/[&<>"']/g, m =>
        ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m])
      );
    }

    clearBtn.addEventListener("click", () => {
      textInput.value = "";
      resultEl.style.display = "none";
      statusEl.textContent = "";
      textInput.focus();
    });

    // ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î Ctrl/Cmd + Enter
    textInput.addEventListener("keydown", (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
        form.dispatchEvent(new Event("submit", { cancelable: true, bubbles: true }));
      }
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const text = textInput.value.trim();
      if(!text){
        showResult("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô", "error");
        return;
      }

      // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏î‡∏ã‡πâ‡∏≥‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏≠‡∏ú‡∏•
      setLoading(true);

      // timeout ‡∏Å‡∏±‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á
      const controller = new AbortController();
      const t = setTimeout(()=>controller.abort(), 20000); // 20s

      try{
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text }),
          signal: controller.signal
        });

        // ‡∏ñ‡πâ‡∏≤ API ‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö CORS browser ‡∏à‡∏∞ block ‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ
        if(!res.ok){
          const msg = `API error: ${res.status} ${res.statusText}`;
          showResult(msg, "error");
          return;
        }

        const data = await res.json();
        // ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö { "scam": true/false }
        if(typeof data.scam === "boolean"){
          showResult(data.scam ? "" : "", data.scam ? "scam" : "ok");
        }else{
          showResult("‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á key: scam)", "error");
        }
      }catch(err){
        // ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏¢‡∏≠‡∏î‡∏Æ‡∏¥‡∏ï: CORS / Timeout / Network
        if (err.name === "AbortError"){
          showResult("‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ (timeout) ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á", "error");
        }else{
          showResult(`‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API (${err.message})`, "error");
        }
      }finally{
        clearTimeout(t);
        setLoading(false);
      }
    });
  </script>
</body>
</html>
